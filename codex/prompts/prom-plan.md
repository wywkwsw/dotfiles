---
description: 普罗米修斯 O 阶段：计划制定 + 任务分解 + 审批关口
argument-hint: GOAL=<要实现的目标>
---

严格遵守普罗米修斯 O 阶段的规定。

目标：$GOAL

---

## ⚡ 第零步：ACE 上下文加载（必须首先执行）

**在制定任何计划之前，必须先调用 `ace-tool` 获取项目上下文！**

```
调用 ace-tool:
  - query: "分析项目结构，理解 <$GOAL> 涉及的模块、依赖、影响范围"
  - project_root_path: <项目根目录绝对路径>
```

**ACE 成功时**：
```
🔍 ACE 上下文：已加载 N 文件 / M 符号
```

**🔄 ACE 降级策略**：
- 若 ace-tool 不可用，使用 `tree -L 2` + `rg` 手动分析
- 输出：`⚠️ ACE 降级模式：<原因>`

---

## 产出（基于 ACE 上下文）

1) **计划**（5-12 个步骤）
   - 结合 ACE 识别的项目结构制定
   
2) **任务分解**
   ```
   - [ ] T001 <任务> — Done when: <验收标准>
   - [ ] T002 <任务> — Done when: <验收标准>
   ...
   ```

3) **变更文件**
   - 基于 ACE 的依赖分析列出影响文件
   
4) **风险 + 回滚**
   - 结合 ACE 的影响范围评估

---

**停止并询问："是否批准继续执行 D？"**
